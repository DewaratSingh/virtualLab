<!DOCTYPE html>
<html>
  <head>
    <title>Virtual Gravity Lab</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font-family: Arial; overflow: hidden; background-color: #1760bf; }
      canvas { position: fixed; top: 0; left: 0; }

      #itemBox {
        position: fixed;
        top: 10px;
        left: 10px;
        z-index: 10;
        width: 250px;
        height: 90vh;
        background: rgba(238,232,232,0.2);
        backdrop-filter: blur(10px);
        border-radius: 8px;
        padding: 10px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        color: white;
      }
      #itemBox label { font-size: 14px; margin-top: 5px; }
      #itemBox input, #itemBox select {
        width: 100%;
        padding: 5px;
        border-radius: 5px;
        border: none;
        margin-bottom: 5px;
      }
      #itemBox button {
        font-size: 16px;
        padding: 10px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        background: #ff9800;
        color: white;
        transition: 0.3s;
      }
      #itemBox button:hover { background: #e68a00; }
      #itemBox div.title { font-size: 18px; text-align: center; margin-bottom: 10px; }
    </style>
  </head>
  <body>

    <div id="itemBox">
      <div class="title">Virtual Physic Lab</div>

      <label>Object Type:</label>
      <select id="objType">
        <option value="ball">Ball</option>
        <option value="rect">Rectangle</option>
      </select>

      <div id="sizeInputs">
        <label id="radiusLabel">Radius:</label>
        <input type="number" id="radius" value="30" min="10" max="100">

        <label id="heightLabel" style="display:none;">Height:</label>
        <input type="number" id="height" value="30" min="10" max="150" style="display:none;">
      </div>

      <label>Mass:</label>
      <input type="number" id="mass" value="1" min="0.1" max="10" step="0.1">

      <label>Elasticity (0-1):</label>
      <input type="number" id="restitution" value="0.8" min="0" max="1" step="0.05">

      <label>Friction (0-1):</label>
      <input type="number" id="friction" value="0.05" min="0" max="1" step="0.01">

      <label>Color:</label>
      <input type="color" id="color" value="#ff0000">

      <button id="addObject">Add Object</button>
      <button id="resetLab">Reset Lab</button>
    </div>

    <canvas id="canvas"></canvas>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <script>
      const { Engine, Render, World, Bodies, Mouse, MouseConstraint, Body } = Matter;

      const engine = Engine.create();
      engine.world.gravity.y = 1;
      const world = engine.world;

      const canvas = document.getElementById("canvas");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const render = Render.create({
        canvas: canvas,
        engine: engine,
        options: { width: window.innerWidth, height: window.innerHeight, wireframes: false, background: '#1760bf' }
      });
      Render.run(render);
      Engine.run(engine);

      const walls = [
        Bodies.rectangle(window.innerWidth/2, window.innerHeight+25, window.innerWidth, 50, { isStatic: true }),
        Bodies.rectangle(window.innerWidth/2, -25, window.innerWidth, 50, { isStatic: true }),
        Bodies.rectangle(-25, window.innerHeight/2, 50, window.innerHeight, { isStatic: true }),
        Bodies.rectangle(window.innerWidth+25, window.innerHeight/2, 50, window.innerHeight, { isStatic: true })
      ];
      World.add(world, walls);

      const mouse = Mouse.create(render.canvas);
      const mouseConstraint = MouseConstraint.create(engine, { mouse: mouse, constraint: { stiffness: 0.2, render: { visible: false } }});
      World.add(world, mouseConstraint);

      let objects = [];

      const objTypeSelect = document.getElementById("objType");
      const radiusInput = document.getElementById("radius");
      const heightInput = document.getElementById("height");
      const radiusLabel = document.getElementById("radiusLabel");
      const heightLabel = document.getElementById("heightLabel");

      objTypeSelect.addEventListener("change", () => {
        if (objTypeSelect.value === "ball") {
          radiusLabel.textContent = "Radius:";
          heightLabel.style.display = "none";
          heightInput.style.display = "none";
        } else {
          radiusLabel.textContent = "Width:";
          heightLabel.style.display = "block";
          heightInput.style.display = "block";
        }
      });

      document.getElementById("addObject").addEventListener("click", () => {
        const type = objTypeSelect.value;
        const mass = parseFloat(document.getElementById("mass").value) || 1;
        const restitution = parseFloat(document.getElementById("restitution").value) || 0.8;
        const friction = parseFloat(document.getElementById("friction").value) || 0.05;
        const color = document.getElementById("color").value || "#ff0000";
        let x = Math.random() * (window.innerWidth - 100) + 50;
        let y = 50;
        let body;

        if (type === "ball") {
          const radius = parseFloat(radiusInput.value) || 30;
          body = Bodies.circle(x, y, radius, { restitution, friction, render: { fillStyle: color }});
        } else {
          const width = parseFloat(radiusInput.value) || 60;
          const height = parseFloat(heightInput.value) || 40;
          body = Bodies.rectangle(x, y, width, height, { restitution, friction, render: { fillStyle: color }});
        }

        Body.setMass(body, mass);
        objects.push(body);
        World.add(world, body);
      });

      document.getElementById("resetLab").addEventListener("click", () => {
        for (let obj of objects) World.remove(world, obj);
        objects = [];
      });

      window.addEventListener("resize", () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        Matter.Render.lookAt(render, { min: { x: 0, y: 0 }, max: { x: window.innerWidth, y: window.innerHeight }});
      });
    </script>
  </body>
</html>
